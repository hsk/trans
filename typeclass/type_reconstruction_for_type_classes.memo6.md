## アジェンダ

  - 要約
  - 1 はじめに
  - 2 Mini-Haskell
  - 3 型推論システム
  - ４ ソート制約付き単一化
  - 5 アルゴリズムW
  - **6 アルゴリズムI**

---

## 6 アルゴリズムI

  Milner(Mil78)の元々の作業のように、アルゴリズムWをより効率的に改良しましました。
  Wと比較して、アルゴリズムI 2は余分な議論をとります。
  この代入は、新しい補題を計算して後で構成する代わりに、段階的に拡張されます。

---

  WとIの同値は簡単なことです。
  名前の変更は、変数を変数にのみマップする注入型の置換です。

---

  定理6.1(WとIの同値性)

  `θ0`は、`θ0E0= E`となるような冪等置換であるとします。
  もし `W(V,Γ,E,e) = (V',Γ',θ',τ')` ならば、`I(V,Γ,θ0,E0,e) = (V'',Γ'',θ'',τ'')` かつ `V'' = σV'`、 `∀α.Γ''α = Γ'(σα)`、 `θ''τ'' = σθ'τ'`、 `θ''E = σθ'E` のような改名 `σ` が存在します。

  `e`の構造上の簡単な誘導による証明。 □

---

  ----

  2(Mil78)のタイポグラフィはあいまいですが、Milnerはメールで、JではなくIであることを意図していることを確認しました: W の必須実装です。
  ミルナーの私は、副作用によって更新される `θ` の1つのグローバルコピーを維持しているので、絶対に必要です。
  純粋に機能的なスタイルでは、これには追加の引数と結果が必要です。

  ----

  <!-- page 21 -->

---

  図7. アルゴリズムI

    I(V,Γ,θ,E,e) = case e of
      x    ⇒ let ∀(αn : Sn)~ .τ  =  E(x)
                              βi  ∉  V [i = 1 ... n]
              in (V ∪ {(βn)~},Γ[(βn : Sn)~],θ,{(αn |→ βn)~}τ)
      λx.e ⇒ let        α ∉ V
              (V',Γ',θ',τ) = I(V ∪ {α},Γ,θ,E[x:α],e)
              in (V',Γ',θ',α → τ)

---

  図7. アルゴリズムI

      (e1 e2) ⇒ let (V1,Γ1,θ1,τ1) = I(V,Γ,θ,E,e1)
                     (V2,Γ2,θ2,τ2) = I(V1,Γ1,θ1,E,e2)
                                 α ∉ V2
                           (Γ',θ') = unify(Γ2,θ2τ1 = θ2τ2 → α)
                in (V2 ∪ {α},Γ',θ'θ2,α)
      let x = e1 in e2 ⇒ let (V1,Γ1,θ1,τ1) = I(Γ,θ,E,e1)
                                    {(αn)~} = FV(θ1τ1) − FV(θ1E)
                          in I(V1,Γ1 \ {(αn)~},θ1,E[x : ∀(αn :Γ1 αn)~ .θ1τ1],e2)


---
