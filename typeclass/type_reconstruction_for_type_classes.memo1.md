---
theme : "white"
---

# 型クラスの型再構築 1

  トビアス・ニプコウ 2、 クリスチャン・プレファー 3

  TU ミュンヘン 4

---

## アジェンダ

  - **要約**
  - 1 はじめに
  - 2 Mini-Haskell
  - 3 型推論システム
  - ４ ソート制約付き単一化
  - 5 アルゴリズムW
  - 6 アルゴリズムI

---

## 要約

  - Haskell のような型クラスを持つシステムの型推論問題を研究
  - 型クラスは、多重定義を持つML形式の多相型の拡張
  - Milnerの多相型に関する研究
    - 型付け判断において型変数を制約する別の文脈を導入することによって一般化
    - 簡単な型推論システムとMLに酷似したアルゴリズムに
  - 具体的には、
    - 束縛解法を用いた構文単一化の拡張である新しい単一化アルゴリズムを提示
    - 主要型の存在は、単一化アルゴリズムの分析に従う

---

## アジェンダ

  - 要約
  - **1 はじめに**
  - 2 Mini-Haskell
  - 3 型推論システム
  - ４ ソート制約付き単一化
  - 5 アルゴリズムW
  - 6 アルゴリズムI

---

## 1 はじめに

  - Hindley/Damas/Milner 多相型の拡張
    - Haskell(HJW92) の型クラスの概念
  - 型クラス
    - Hindley/Damas/Milner システムの利点を保持
    - 関数名の体系的なオーバーロードを可能にする
    - すべての型付き式は、自動的に推論できる最も一般的な型
  - Haskell 型のシステムへの拡張は既に提案(実装)されていた
  - Haskell の型推論アルゴリズムの本質はまだ単純化されていなかった

---

### この論文の主な目的

  - 特に単純なアルゴリズムを提供
    - 実装者にとっての貢献
  - 同時に、対応する単純な型推論システムを提示
    - 言語のユーザーを対象
  - 推論システムに関してアルゴリズムの健全性と完全性を厳密に証明
    - アルゴリズムと推論システム
      - どちらもML対応のものと非常によく似ています
    - 証明はかなり複雑

---

### Haskellの型クラス

  - 本質的には一連の型(ある種の関数を提供する)
  - 古典的な例は等価演算子

---

### standard ML より前のバージョン

  - 等式関数 `=` は多相型 `∀α.α → α → bool` を持ち、 
  - ここで、型変数 `α` はすべての型にわたる
  - ただし、 `=` は関数型の引数には適用しない事

### standard ML (MTH90) 

  - 等価が定義されている型の範囲にしかない特殊な型変数を導入
  - 等価性は、他の多型関数とは限られた領域だけでなく、多形性と多重定義が混在しているためにも異なる
  - リストの等価性は、整数の等価性とは異なって実装

---

  <!-- page 2 -->

### 型クラス

  - 型クラス
    - 両方の問題を系統的に扱う
  - 型変数α
    - すべての "等価型" のクラスである特定の型クラスの要素
    - たとえば `Eq` に制限
  - 各型 `τ` について `=` を定義する必要がある場合
    - `τ` が型 `τ → τ → bool` の実装を提供
    - `τ` がクラス `Eq` であると宣言しなければならない

---

### 判断 `τ : C`

  - 型 `τ` があるクラス `C` にあるという事実を表現するために、
    - 判断 `τ : C` を導入 1

  ----

  1 クラスが型の述語として見られる場合、これは Haskell 表記 `C(τ)` につながります。

---

### Nipkow と Snelting (NS91)

  - Haskell を式、型、クラスの3つのレベルのシステムとして見る
    - クラスが型を分類
      - Nipkow と Snelting (NS91) に遡る
  - 型が複数のクラスに属することを表現することは不可能

---

### ソート

  - この困難を克服するために、有限集合クラスとしてソートを導入
  - 判断 `τ : {C1, ..., Cn}`
    - 接続詞 `τ : C1 ∧ ... ∧ τ : Cn` の省略形
    - あるいは、`C1 ∩ ... ∩ Cn` の表記法
      - `C1` 〜 `Cn` は クラス
  - 単純な型推論システムおよびアルゴリズムにつながる

---

### 相違点

  - 前者はMini-ML(CDDK86)と似ている
  - 後者はMilner(Mil78)のアルゴリズムIと非常に似ている
  - 主な相違点
    - `α : {C1, ..., Cn}` 形式の制約の集合を計算
      - `α` は型変数

---
